- model_class = Employee
= search_form_for @ransack_employees, as: :employees_search, url: employees_path do |f|
  %br
  .card.card-default
    .container
      .card-heading
        %h4.card-title.float-left{:style => "padding-top: 7.5px;"} 
          %b
            =t '.title', :default => model_class.model_name.human.pluralize.titleize
            = f.search_field :last_name_cont, autofocus: true, placeholder: "Surname"
            = f.submit
            = link_to '', employees_path, class: "btn btn-secondary fa fa-redo", title: 'Refresh', 'data-toggle' => 'tooltip', 'data-placement' => 'top'
        %h4.card-title.float-right{:style => "padding-top: 7.5px;"} 
          = link_to 'New Employee', new_employee_path, class: 'btn btn-sm btn-primary'
    %table
      %thead
        %tr
          %th= sort_link @ransack_employees, :last_name, "Name"
          %th Phone number
          %th Email
          %th Date of birth
          %th= sort_link @ransack_employees, :status, "Status"
          %th= sort_link @ransack_employees, :balance, "Balance"
          %th= sort_link @ransack_employees, :jobs_count, "Jobs"
          %th Base Location
          %th
          %th
          %th
    
      %tbody
        - @employees.each do |employee|
          %tr
            %td= employee.full_name
            %td= employee.phone_number
            %td= employee.email
            %td= employee.date_of_birth
            %td= status_label(employee.status)
            %td= number_to_currency(employee.balance_cents, :unit => "$")
            %td= employee.jobs_count
            %td= employee.location
            %td
              - if employee.user.present?
                - if employee.user.invitation_accepted_at?
                  Account Active. Can delete
                  /= link_to 'x account', employee.user, :method => :delete, :data => { :confirm => 'Are you sure?' }, class: "btn btn-danger btn-xs"
                - else 
                  Invitation sent. Can delete
                  /= link_to 'x invitation', employee.user, :method => :delete, :data => { :confirm => 'Are you sure?' }, class: "btn btn-info btn-xs"
              - else
                - if employee.email.present?
                  = simple_form_for(User.new, url: user_invitation_path) do |z|
                    = z.input :email, input_html: {value: employee.email}, as: :hidden
                    = z.input :employee_id, input_html: {value: employee.id}, as: :hidden
                    = z.button :submit, 'Invite', class: "btn btn-success btn-xs"
                - else
                  Add email to invite user
            %td= link_to 'Show', employee, class: 'btn btn-sm btn-primary'
            %td= link_to 'Edit', edit_employee_path(employee), class: 'btn btn-sm btn-warning'
            %td= link_to 'Destroy', employee, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger'
    .container
      = will_paginate @employees, renderer: WillPaginate::ActionView::BootstrapLinkRenderer
%br
