%nav.navbar.fixed-top.navbar-expand-lg.navbar-dark
  %a.navbar-brand{:href => "/"}
    /= image_tag "logo and name.png", height: "25px", class: "mx-auto d-inline align-top", :alt => "logo"
    - if Tenant.current_tenant.logo.attached?
      = image_tag Tenant.current_tenant.logo, height: "30px", class: "mx-auto d-inline align-top rounded"
    - else
      %i.far.fa-calendar-check
    .badge.badge-default 
      XLPLAN
      = plan_label(Tenant.current_tenant.plan)
      = Tenant.current_tenant.name
      /= @org_name
    /zubCRM
    /= link_to plan_label(Tenant.current_tenant.plan), edit_plan_path, class: 'badge badge-default'
    /%ul.navbar-nav
    /= Time.now.in_time_zone(current_user.time_zone)
    /= Time.now
    /= Time.current
    /= Time.zone
    /= Time.zone.now
    /= Time.now.in_time_zone
    /%a{:href => "viber://pa?chatURI=[public account URI]&text=[message text]"} some text
    /%a{:href => "viber://chat/?number=+380960459047"} Viber Chat
    /%a{:href => "viber://contact?number=+380960459047"} Viber Contact
    /%a{:href => "viber://chat?number=+380960459047"} Viber
    /%a{:href => "viber://add?number=+380960459047"} Viber
  %a.navbar-toggler{"data-target" => ".sidebar", "data-toggle" => "collapse", :href => ""}
    %span.navbar-toggler-icon
  .collapse.navbar-collapse.sidebar
    - if Tenant.current_tenant.plan == "demo"
      .nav-item= link_to "<i class='fa-color-1 fa-fw fa fa-shopping-cart'></i> #{t('sidebar.order_system')}".html_safe, edit_plan_path, class: 'btn btn-sm btn-danger mb-1 mt-1'
    %ul.navbar-nav.ml-md-auto.d-md-flex
      = search_form_for @ransack_clients, as: :clients_search, url: search_clients_path, html: { method: :post }  do |f|
        .input-group
          = f.search_field :full_name_cont, class: 'form-control', style: 'float: left; width: 150px; ', placeholder: t('sidebar.search_client'), :autocomplete => :off
          %span.input-group-append
            %button.btn.btn-primary{:type => "submit"}
              %span.fa.fa-search{"aria-hidden" => "true"}
    %ul.navbar-nav.side-nav
      ////link to ransack search query
      /%li.nav-item= link_to "<i class='fa fa-calendar-alt'></i> #{t('sidebar.calendar')}".html_safe, calendar_path(q: {jobs_member_id_eq: current_user.member.id}), class: "nav-link"
      ////links to dropdown with create
      /%li.nav-item.dropdown
      /  %a#navbarDropdownCreate.nav-link.dropdown-toggle{"aria-expanded" => "false", "aria-haspopup" => "true", "data-toggle" => "dropdown", :href => "#", :role => "button"}
      /    .fa-color-1.fa.fa-plus
      /    #{t('sidebar.create')}
      /  .dropdown-menu{"aria-labelledby" => "navbarDropdownCreate"}
      /    = link_to "<i class='fa-fw fa fa-plus'></i> #{t('sidebar.new_event')}".html_safe, new_event_path, class: "dropdown-item navdrop-link"
      /    = link_to "<i class='fa-fw fa fa-plus'></i> #{t('sidebar.new_client')}".html_safe, new_client_path, class: "dropdown-item navdrop-link"
      /    = link_to "<i class='fa-fw fa fa-plus'></i> #{t('sidebar.new_payment')}".html_safe, new_inbound_payment_path, class: "dropdown-item navdrop-link"
      /    = link_to "<i class='fa-fw fa fa-plus'></i> #{t('sidebar.member')}".html_safe, new_member_path, class: "dropdown-item navdrop-link"
      /    = link_to "<i class='fa-fw fa fa-plus'></i> #{t('sidebar.service')}".html_safe, new_service_path, class: "dropdown-item navdrop-link"
      /    = link_to "<i class='fa-fw fa fa-plus'></i> #{t('sidebar.location')}".html_safe, new_location_path, class: "dropdown-item navdrop-link"
      /    = link_to "<i class='fa-fw fa fa-plus'></i> #{t('sidebar.service_category')}".html_safe, new_service_category_path, class: "dropdown-item navdrop-link"
      ////alternative dropdown
      /%a.nav-link.btn.dropdown-toggle{"data-target" => "#stats", "data-toggle" => "collapse"}
      /  .fa-color-1.fa.fa-chart-line
      /  #{t('sidebar.stats')}
      /%ul#stats.sub-menu.collapse
      /  .nav-item= link_to "<i class='fa-color-1 fa-fw fa fa-hand-holding-usd'></i> #{t('sidebar.inbound_payments')}".html_safe, dashboard_payments_path, class: "nav-link"
      /  .nav-item= link_to "<i class='fa-color-1 fa-fw fa fa-calendar'></i> #{t('sidebar.events')}".html_safe, dashboard_events_path, class: "nav-link"
      /  .nav-item= link_to "<i class='fa-color-1 fa-fw fa fa-user'></i> #{t('sidebar.clients')}".html_safe, dashboard_clients_path, class: "nav-link"
      /  .nav-item= link_to "<i class='fa-color-1 fa-fw fa fa-user-tie'></i> #{t('sidebar.members')}".html_safe, dashboard_members_path, class: "nav-link"
      /CALENDAR
      %li.nav-item= link_to "<i class='fa-color-1 fa-fw fa fa-calendar-alt'></i> #{t('sidebar.calendar')}".html_safe, calendar_path, class: "nav-link"
      /SEARCH CLIENT IN SIDEBAR
      /.input-group
      /  = search_form_for @ransack_clients, as: :clients_search, url: search_clients_path, html: { method: :post }  do |f|
      /    = f.search_field :full_name_cont, class: 'form-control', style: 'float: left; width: 150px; ', placeholder: t('sidebar.search_client'), :autocomplete => :off
      /    %span.input-group-append
      /      %button.btn.btn-secondary{:type => "submit"}
      /        %span.fa.fa-search{"aria-hidden" => "true"}
      /CREATE NEW
      %li.nav-item
        = link_to new_event_path, class: "nav-link" do 
          .fa-color-1.fa-fw.fa.fa-plus
          .fa-color-1.fa-fw.fa.fa-calendar
          = t('sidebar.new_event')
      %li.nav-item
        = link_to new_client_path, class: "nav-link" do 
          .fa-color-1.fa-fw.fa.fa-plus
          .fa-color-1.fa-fw.fa.fa-user
          = t('sidebar.new_client')
      %li.nav-item
        = link_to new_inbound_payment_path, class: "nav-link" do 
          .fa-color-1.fa-fw.fa.fa-plus
          .fa-color-1.fa-fw.fa.fa-hand-holding-usd
          = t('sidebar.new_payment')
      /LINKS WITH COUNTERS
      - if Tenant.current_tenant.online_booking
        %li
          = link_to leads_path, class: "nav-link" do
            .fa-color-1.fa-fw.fa.fa-globe-africa
            #{t('sidebar.online_booking')} #{content_tag :span, Lead.count, class: 'badge badge-danger'} 
      - if Event.today.count > 0
        %li
          = link_to today_events_path, class: "nav-link" do
            .fa-color-1.fa-fw.fa.fa-calendar-check
            #{t('sidebar.events_today')} #{content_tag :span, Event.today.count, class: 'badge badge-danger'} 
      - if Event.tomorrow.count > 0
        %li
          = link_to tomorrow_events_path, class: "nav-link" do
            .fa-color-1.fa-fw.fa.fa-calendar-check
            #{t('sidebar.events_tomorrow')} #{content_tag :span, Event.tomorrow.count, class: 'badge badge-danger'} 
      - if Event.close.count > 0
        %li
          = link_to close_events_path, class: "nav-link" do
            .fa-color-1.fa-fw.fa.fa-calendar-check
            #{t('sidebar.close_events')} #{content_tag :span, Event.close.count, class: 'badge badge-danger'} 
      - if Client.bday_today.count > 0
        %li
          = link_to bday_today_clients_path, class: "nav-link" do
            .fa-color-1.fa-fw.fa.fa-birthday-cake
            #{t('sidebar.bday_today')} #{content_tag :span, Client.bday_today.count, class: 'badge badge-danger'} 
      - if Client.debtors.count > 0
        %li
          = link_to debtors_clients_path, class: "nav-link" do
            .fa-color-1.fa-fw.fa.fa-user
            #{t('sidebar.debtors')} #{content_tag :span, Client.debtors.count, class: 'badge badge-danger'} 
      - if Client.no_gender.count > 0
        %li
          = link_to no_gender_clients_path, class: "nav-link" do
            .fa-color-1.fa-fw.fa.fa-user
            #{t('sidebar.no_gender')} #{content_tag :span, Client.no_gender.count, class: 'badge badge-danger'} 
      /LINKS
      %li.nav-item
        = link_to clients_path, class: "nav-link" do 
          .fa-color-1.fa-fw.fa.fa-user
          = t('sidebar.clients')
      %li.nav-item
        = link_to members_path, class: "nav-link" do 
          .fa-color-1.fa-fw.fa.fa-user-tie
          = t('sidebar.members')
      %li.nav-item
        = link_to services_path, class: "nav-link" do 
          .fa-color-1.fa-fw.fa.fa-hand-paper
          = t('sidebar.services')
      %li.nav-item
        = link_to locations_path, class: "nav-link" do 
          .fa-color-1.fa-fw.fa.fa-map-marker-alt
          = t('sidebar.locations')
      %li.nav-item.dropdown
        %a#navbarDropdown3.nav-link.dropdown-toggle{"aria-expanded" => "false", "aria-haspopup" => "true", "data-toggle" => "dropdown", :href => "#", :role => "button"}
          .fa-color-1.fa.fa-chevron-circle-down
          #{t('sidebar.more')}
        .dropdown-menu{"aria-labelledby" => "navbarDropdown3"}
          = link_to events_path, class: "dropdown-item navdrop-link" do 
            .fa-fw.fa.fa-calendar
            = t('sidebar.all_events')
          = link_to inbound_payments_path, class: "dropdown-item navdrop-link" do 
            .fa-fw.fa.fa-hand-holding-usd
            = t('sidebar.all_inbound_payments')
          = link_to expences_path, class: "dropdown-item navdrop-link" do 
            .fa-fw.fa.fa-dollar-sign
            = t('sidebar.all_expences')
          = link_to service_categories_path, class: "dropdown-item navdrop-link" do 
            .fa-fw.fa.fa-hand-paper
            = t('sidebar.service_categories')
          /.dropdown-divider
          = link_to leads_path, class: "dropdown-item navdrop-link" do
            .fa-fw.fa.fa-globe-africa
            #{t('sidebar.online_booking')} 
          = link_to contacts_list_path, class: "dropdown-item navdrop-link" do 
            .fa-fw.fa.fa-user-plus
            = t('sidebar.import_contacts')
          = link_to activity_path, class: "dropdown-item navdrop-link" do 
            .fa-fw.fa.fa-bell
            = t('sidebar.activity')
          = link_to start_path, class: "dropdown-item navdrop-link" do 
            .fa-fw.fa.fa-rocket
            = t('sidebar.start')
      - if current_user.has_role?(:admin)
        %li.nav-item
          = link_to settings_show_path, class: "nav-link" do 
            .fa-color-1.fa-fw.fa.fa-cog
            = t('sidebar.settings')
            /%small= Tenant.current_tenant.name
            .badge.badge-dark admin
        %li.nav-item.dropdown
          %a#navbarDropdown2.nav-link.dropdown-toggle{"aria-expanded" => "false", "aria-haspopup" => "true", "data-toggle" => "dropdown", :href => "#", :role => "button"}
            .fa-color-1.fa.fa-chart-line
            #{t('sidebar.stats')}
            .badge.badge-dark admin
          .dropdown-menu{"aria-labelledby" => "navbarDropdown2"}
            = link_to dashboard_payments_path, class: "dropdown-item navdrop-link" do 
              .fa-fw.fa.fa-chart-line
              .fa-fw.fa.fa-hand-holding-usd
              = t('sidebar.inbound_payments')
            = link_to dashboard_expences_path, class: "dropdown-item navdrop-link" do 
              .fa-fw.fa.fa-chart-line
              .fa-fw.fa.fa-dollar-sign
              = t('sidebar.expences')
            = link_to dashboard_events_path, class: "dropdown-item navdrop-link" do 
              .fa-fw.fa.fa-chart-line
              .fa-fw.fa.fa-calendar
              = t('sidebar.events')
            = link_to dashboard_clients_path, class: "dropdown-item navdrop-link" do 
              .fa-fw.fa.fa-chart-line
              .fa-fw.fa.fa-user
              = t('sidebar.clients')
            = link_to dashboard_members_path, class: "dropdown-item navdrop-link" do 
              .fa-fw.fa.fa-chart-line
              .fa-fw.fa.fa-user-tie
              = t('sidebar.members')
    %ul.navbar-nav.ml-md-auto.d-md-flex
      %li.nav-item.dropdown
        %a#navbarDropdown.nav-link.dropdown-toggle{"aria-expanded" => "false", "aria-haspopup" => "true", "data-toggle" => "dropdown", :href => "#", :role => "button"}
          .fa-color-1.fa-fw.fa.fa-user
          /- if user_signed_in? && current_user.member.present?
          /- if user_signed_in?
          = current_user.member.short_name
          /- if current_user.has_role?(:admin)
          /  .badge.badge-dark admin
        .dropdown-menu.dropdown-menu-right{"aria-labelledby" => "navbarDropdown"}
          = link_to t('sidebar.my_page'), member_path(current_user.member), class: "dropdown-item"
          = link_to t('sidebar.profile_settings'), edit_member_path(current_user.member), class: "dropdown-item"
          = link_to t('sidebar.account_settings'), edit_user_registration_path, class: "dropdown-item"
          = link_to t('sidebar.logout'), destroy_user_session_path, :method => :delete, class: "dropdown-item"
